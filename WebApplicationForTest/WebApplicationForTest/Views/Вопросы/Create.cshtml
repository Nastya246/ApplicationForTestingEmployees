@model WebApplicationForTest.Models.ВопросОтветРедактор

@{
    ViewBag.Title = "Добавить вопрос";
    Layout = "~/Views/Shared/_Layout.cshtml";
   
}
<div>
    <link href='@Url.Content("~/Content/themes/base/all.css")' rel="stylesheet" type="text/css" />
    <script src='@Url.Content("~/Scripts/jquery-ui-1.12.1.min.js")' type="text/javascript"></script>

    <h2>Добавить вопрос в тест</h2>
    <p>
        @Html.ActionLink("К списку вопросов", "Index", new { topic = @ViewBag.Тест, redactor = "redactor" })

        @Html.ActionLink("К списку тем", "Index", "Тесты", new { razdel = @ViewBag.Раздел, redactor = "redactor" }, null)
        @Html.ActionLink("К списку разделов", "Index", "Разделы", new { redactor = "redactor" }, null)
    </p>
    <p>
        <big>
            <ul>
                <li>
                    "Выбор" - вопрос с несколькими вариантами ответов, из которых лишь один верный. <br />
                </li>
                <li>  "Ввод" - вопрос с ответом в свободной форме, варианты ответов для этого типа не указываются. <br /></li>
                <li>  "Несколько" - вопрос с несколькими вариантами ответов, из которых несколько вариантов правильны.<br /> </li>
                <li>
                    "Разрыв" - вопрос с пропущенными словами в тексте. При вводе текста в поле "Текст Вопроса" на месте пропуска слова введите "...". В правильных ответах укажите правильные варианты по их порядку в тексте через запятую, остальные поля не заполняются <br />
                </li>
                <li>
                    "Соотношение" - вопрос, где требуется соотнести понятия. В поле "Правильный ответ" укажите ответы в верном порядке через запятую. Например, вопрос "Соотнесите страны и города", в поле "Варианты понятий" введите "Россия, Франция, Китай", тогда поле "Правильный ответ" - "Москва, Париж, Пекин", остальные поля не заполняются<br />
                </li>
            </ul>
        </big>
    </p>

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        <input type="hidden" value="redactor" name=redactor />
        <input id="id_Теста" name="id_Теста" type="hidden" value=@ViewBag.Тест class="form-control" />
        <div class="form-horizontal">
            <h4>Вопросы</h4>
            <hr />
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div class="form-group">
                @Html.LabelFor(model => model.вопросыРедактор.Тип_ответа, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    <select id="Тип_ответа" name="Тип_ответа" autofocus required>
                        <option value="--Выбор типа вопроса--">--Выбор типа вопроса--</option>
                        <option value="Выбор">Выбор</option>
                        <option value="Ввод">Ввод</option>
                        <option value="Несколько">Несколько</option>
                        <option value="Разрыв">Разрыв</option>
                        <option value="Соотношение">Соотношение</option>
                    </select>
                    @Html.ValidationMessageFor(model => model.вопросыРедактор.Тип_ответа, "", new { @class = "text-danger" })
                    <br />
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.вопросыРедактор.Текст_вопроса, htmlAttributes: new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    @Html.TextAreaFor(model => model.вопросыРедактор.Текст_вопроса, new { cols = "50", rows = "4", htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.вопросыРедактор.Текст_вопроса, "", new { @class = "text-danger" })
                    <br />
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="button" id="plusButton" name="plusButton" value="+ вариант" class="btn btn-default" style="display:none" />
                </div>
                <div class="c">
                    <div id="newVariant">  </div>


                    <div class="form-group">
                        @Html.Label("Варианты понятий (через \";\"):", new { @style = "display:none" })
                        <div class="col-md-10">
                            @Html.TextBoxFor(model => model.Понятия, new { @id = "Def", @class = "form-control", @style = "display:none", @disabled = "disabled" })
                            <!--Html.TextBox("def", null, new { class = "form-control", style = "width:500px", disabled = "disabled" })-->
                        </div>
                    </div>

                    <div class="form-group">
                        @Html.Label("Правильный ответ/ответы (через \";\"):", new { @style = "display:none" })
                        <div class="col-md-10">
                            @Html.TextBoxFor(model => model.Правильный_ответ, new { @id = "correctAnsw", @class = "form-control", @style = "display:none", @disabled = "disabled" })
                            @Html.ValidationMessageFor(model => model.Правильный_ответ, "", new { @class = "text-danger", @style = "display:none" })
                            <br />
                        </div>
                    </div>
                </div>

            </div>

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="button" id="deleteButton" name="deleteButton" value="- вариант" class="btn btn-default" style="display:none" />
                </div>

               
                    <div class="col-md-offset-2 col-md-10">
                        <br />  <br /><input type="submit" id="Submit" name="Submit" value="Добавить" class="btn btn-default" disabled="disabled" />
                    </div>
                </div>
            </div>
            }

            <div>
                <form method="post" action="~/Home/Menu">
                    <input type="hidden" value="1" name="redactorForBack" />

                    <input type="submit" value="В меню" />
                </form>
            </div>
            @section Scripts {
                @Scripts.Render("~/bundles/jqueryval")
                <script type="text/javascript">
                    $(function () {

           $('#Тип_ответа').change(function()
        {
            // получаем выбранное значение
               var id = $(this).val();
               if ($('#Тип_ответа').val() == "--Выбор типа вопроса--") {
                   document.getElementById('Submit').disabled = true;
               }
               else { document.getElementById('Submit').disabled = false; }
               if ($('#Тип_ответа').val() == "Выбор" || $('#Тип_ответа').val() == "Несколько") {
                   document.getElementById('plusButton').style.display = "block";
                   document.getElementById('deleteButton').style.display = "block";
               }
               else {
                   document.getElementById('plusButton').style.display = "none";
                   document.getElementById('deleteButton').style.display = "none";
               }

                     $.ajax({
                type: 'GET',
                url: '@Url.Action("GetElement")/' + id,
                success: function (data) {

                    // заменяем содержимое присланным частичным представлением
                   // $('#def').replaceWith(data);
                    $("div.c").replaceWith(data);

                }
            });
        });
        })
                    var n = 0;
                    var arCount = 0;
                    let ar = new Array();
 $(function () {
    
     $('#plusButton').click(function ()
           {
               
               if ($('#Тип_ответа').val() == "Выбор" || $('#Тип_ответа').val() == "Несколько") {
                  
                   if ($('#Тип_ответа').val() == "Выбор") {
                       document.getElementById('newVariant').insertAdjacentHTML('beforeend', '   <br /> <input type=text id="id_' + n + '" name="InputVariant" ><input checked="checked" id="id' + n + '" name="RadioB" type="radio" value="' + n + '" />');
                   }
                   else {
                       document.getElementById('newVariant').insertAdjacentHTML('beforeend', '<br /> <input type=text id="id_' + n + '" name="InputVariant" > <input id="id' + n + '" name="Checkbox" type="checkbox" value="true" /> <input id="id' + n + '" name = "Checkbox" type = "hidden" value = "false" />  ');
                   }
                   ar[n] = "id_" + n;
                   
                   n++
                   document.getElementById('correctAnsw').style.display="none";
                   document.getElementById('Def').style.display = "none";
                    }
            });
        })
                    $(function () {

                        $('#deleteButton').click(function () {

                            if ($('#Тип_ответа').val() == "Выбор" || $('#Тип_ответа').val() == "Несколько") {
                               
                                document.getElementById(ar[arCount]).remove();
                                arCount++;
                                document.getElementById('correctAnsw').style.display = "none";
                                document.getElementById('Def').style.display = "none";
                               
                            }
                        });
                    })
                </script>

            }
        </div>
